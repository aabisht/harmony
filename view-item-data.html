<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title>View Item | Bristol Farms</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Place favicon.ico in the root directory -->
  <link rel="icon" type="image/x-icon" href="favicon.ico">

  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600|Raleway:400,600,700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons&display=block" rel="stylesheet">
  <link href="./css/vendor/fontawesome.css" rel="stylesheet">
  <link rel="stylesheet" href="./css/vendor/datepicker.min.css">
  <link rel="stylesheet" href="./css/vendor/materialize.min.css">
  <link rel="stylesheet" href="css/styles.css">

  <meta name="theme-color" content="#fafafa">
</head>

<body class="left-menu-fixed">

  <div class="body-container-wrapper">
    <div class="body-wrapper">

      <!-- Header -->
      <header class="header-container">
        <div class="header-container-wrapper">
          <div class="container-fluid">
            <div class="row">
              <div class="col-sm-10 header-left-wrapper">
                <div class="cell-wrapper">
                  <div class="header-title-nav-wrapper">
                    <div class="title">
                      <h3>View Item</h3>
                      <div aria-label="breadcrumb">
                        <ol class="breadcrumb">
                          <li class="breadcrumb-item"><a href="/">Home</a></li>
                          <li class="breadcrumb-item active" aria-current="page">View Item</li>
                        </ol>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-2 header-right-wrapper text-right">
                <div class="cell-wrapper">
                  <div class="header-dropdown-wrapper">
                    <a href="javascript:;" class="header-dropdown-trigger"><i class="far fa-user-circle"></i></a>
                    <div class="dropdown-menu text-left">
                      <div class="header-dropdown-user-profile-wrapper text-center">
                        <div class="user-avatar-wrapper">
                          <i class="far fa-user-circle"></i>
                        </div>
                        <div class="user-detail-wrapper">
                          <h3><a href="javascript:;">User Name</a></h3>
                          <h5>Admin</h5>
                        </div>
                      </div>
                      <ul>
                        <li><a href="javascript:;">Menu 1</a></li>
                        <li><a href="javascript:;">Menu 2</a></li>
                        <li><a href="javascript:;">Menu 3</a></li>
                        <li><a href="javascript:;">Logout</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Left Menu -->
      <div class="left-menu-wrapper"></div>

      <!-- Main Body Content -->
      <div class="main-body-content-wrapper">
        <div class="main-body-content-container">

          <div class="header-search-wrapper">
            <div class="container-fluid">
              <div class="card header-search-card-wrapper">
                <div class="card-content">
                  <h3 class="card-title d-flex flex-row justify-content-between d-flex align-items-center">
                    <span>Search</span>
                    <div class="header-search-dropdown-wrapper">
                      <a href="javscript:;" class="button-primary button-stroked dropdown-trigger save-search-trigger" data-target='savedSearchWrapper'>Saved Search <i class="fas fa-caret-down"></i></a>
                      <ul id='savedSearchWrapper' class='dropdown-content saved-search-wrapper'>
                        <li class="header-saved-search-item"><a href="javscript:;">Grocery Items</a> <a href="javascript:;" class="removed-saved-search-modal modal-trigger" data-target="deleteSavedSearchModal" data-item="1" data-name="Grocery Items"><i class="far fa-trash-alt"></i></a></li>
                        <li class="header-saved-search-item"><a href="javscript:;">Vendor X Items</a> <a href="javascript:;" class="removed-saved-search-modal modal-trigger"  data-target="deleteSavedSearchModal" data-item="2" data-name="Vendor X Items"><i class="far fa-trash-alt"></i></a></li>
                        <li class="header-saved-search-item"><a href="javscript:;">Organic Items </a> <a href="javascript:;" class="removed-saved-search-modal modal-trigger"  data-target="deleteSavedSearchModal" data-item="3" data-name="Organic Items"><i class="far fa-trash-alt"></i></a></li>
                      </ul>
                    </div>
                  </h3>
                  <div class="row header-search-input-wrapper align-items-start justify-content-center">
                    <div class="col-md-1">
                      <div class="cell-wrapper">
                        <div class="input-field">
                          <input id="UPC_PLU_Search" type="text" value="" autocomplete="off" placeholder="Enter UPC/PLU value">
                          <label for="UPC_PLU_Search" class="active">UPC/PLU</label>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="cell-wrapper">
                        <div class="input-field">
                          <input id="Item_Description_Search" type="text" value="" autocomplete="off" placeholder="Enter Item Description value">
                          <label for="Item_Description_Search" class="active">Item Description</label>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="cell-wrapper">
                        <div class="input-field">
                          <select>
                            <option value="" disabled selected>Choose</option>
                            <option value="1">Option 1</option>
                            <option value="2">Option 2</option>
                            <option value="3">Option 3</option>
                          </select>
                          <label>Department</label>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="cell-wrapper">
                        <div class="input-field">
                          <select>
                            <option value="" disabled >Choose</option>
                            <option value="1" selected>Option 1</option>
                            <option value="2">Option 2</option>
                            <option value="3">Option 3</option>
                          </select>
                          <label>Category</label>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="cell-wrapper">
                        <div class="input-field">
                          <input id="Brand_Search" type="text" value="" autocomplete="off" placeholder="Enter Brand value">
                          <label for="Brand_Search" class="active">Brand</label>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="cell-wrapper">
                        <div class="input-field">
                          <select>
                            <option value="" disabled >Choose</option>
                            <option value="1">Option 1</option>
                            <option value="2" selected>Option 2</option>
                            <option value="3">Option 3</option>
                          </select>
                          <label>Vendor Name</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row header-search-btn-wrapper align-items-start justify-content-center">
                    <div class="col-sm-12">
                      <div class="cell-wrapper d-flex flex-row justify-content-between align-items-center">
                        <div class="button-wrapper text-center">
                          <a href="#saveSearchModal" class="button-primary button-adv-seach modal-trigger">Save Search</a>
                        </div>
                        <div class="button-wrapper text-center">
                          <a href="#advSeachModal" class="button-primary button-stroked button-adv-seach modal-trigger">Advance Search</a>
                          <a href="/view-item-data.html" class="button-primary button-search">Search</a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="main-body-data-wrapper">
            <div class="container-fluid">
              <div class="card">
                <div class="card-content">
                  <div class="card-header d-flex flex-row justify-content-between align-items-center">
                    <div class="card-title-wrapper">
                      <h3 class="card-title">
                        View Item
                        <span id="select-row-num"></span>
                      </h3>
                    </div>
                    <div class="card-header-action-wrapper" id="cardHeaderAction">
                      <div class="button-wrapper d-flex flex-row justify-content-end align-items-center">
                        <div class="input-field header-action-item">
                          <select>
                            <option value="show_all" selected>Show all</option>
                            <option value="show_original_items _only">Show Original</option>
                            <option value="show_draft_items_only">Show Draft</option>
                          </select>
                        </div>
                        <button type="button" class="button-primary button-stroked saveRow header-action-item">Save Row</button>
                        <div class="button-primary button-with-dropdown header-action-item">
                          <a href="javascript:;" class="addNewRow">Add New</a>
                          <a href="javascript:;" class="dropdown-trigger" data-target='addNewDropdown'><i class="fas fa-caret-down"></i></a>
                          <ul id='addNewDropdown' class='dropdown-content'>
                            <li><a href="javascript:;">Single Item</a></li>
                            <li><a href="javascript:;">Bulk Upload</a></li>
                          </ul>
                        </div>
                        <!-- <button type="button" class="button-primary button-stroked addNewRow header-action-item">Add New</button> -->
                      </div>
                    </div>
                  </div>
                  <div class="datatable-wrapper">
                    <div id="datatable" class="datatable ag-theme-material"></div>
                    <div class="datatable-action-item-select">
                      <div class="d-flex flex-row justify-content-end align-items-center">
                        <span class="page-size-label">Item to Show</span>
                        <select onchange="onPageSizeChanged()" id="page-size">
                          <option value="10">10</option>
                          <option value="20">20</option>
                          <option value="50">50</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>

  <div id="advSeachModal" class="modal modal-fixed-footer">
    <div class="modal-content">
      <div class="modal-title"><h3>Add New Field</h3></div>
      <div class="modal-form-wrapper">
        <div class="modal-form-item modal-form-item-1" data-index="1">
          <div class="row align-items-start justify-content-center">
            <div class="col-md-10 modal-form-input-wrapper">
              <div class="row align-items-start justify-content-center">
                <div class="col-sm-4">
                  <div class="cell-wrapper">
                    <div class="input-field">
                      <select id="modal-attribute-list-1" class="modal-attribute-list">
                        <option value="" disabled selected>Choose Attribute List</option>
                        <option value="1">Option 1</option>
                        <option value="2">Option 2</option>
                        <option value="3">Option 3</option>
                      </select>
                      <label for="modal-attribute-list-1">Attribute List</label>
                    </div>
                  </div>
                </div>
                <div class="col-sm-4">
                  <div class="cell-wrapper">
                    <div class="input-field">
                      <select id="modal-operator-1" class="modal-operator">
                        <option value="" disabled selected>Choose Operator</option>
                        <option value="contains">CONTAINS</option>
                        <option value="equals">EQUALS</option>
                        <option value="starts">STARTS</option>
                      </select>
                      <label for="modal-operator-1">Operator</label>
                    </div>
                  </div>
                </div>
                <div class="col-sm-4">
                  <div class="cell-wrapper">
                    <div class="input-field">
                      <input placeholder="Enter default value" id="modal-value-1" type="text" class="modal-value">
                      <label for="modal-value-1">Value</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-2 modal-form-input-action-wrapper">
              <div class="button-wrapper d-none">
                <a href="javascript:;" class="button-primary button-stroked tooltip modal-button-clear-row" data-tooltip="Clear Field"><i class="fas fa-times-circle"></i></a>
                <a href="javascript:;" class="button-primary button-stroked tooltip modal-button-remove-row" data-tooltip="Remove Field"><i class="fas fa-minus-circle"></i></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <div class="button-wrapper">
        <a href="javscript:;" class="button-primary button-stroked modal-button-add-more">Add More</a>
        <a href="/view-item-adv-search-filed.html" class="modal-close button-primary modal-button-submit">Submit</a>
      </div>
    </div>
  </div>

  <div id="deleteSavedSearchModal" class="modal">
    <div class="modal-content">
      <p>Are you sure you want to delete <strong id="deleteSavedSearchName"></strong> from saved search.</p>
    </div>
    <div class="modal-footer">
      <a href="javascript:;" class="modal-close button-stroked button-primary"><i class="fas fa-times"></i> Cancel</a>
      <a href="javascript:;" class="modal-close button-primary removed-saved-search"><i class="far fa-trash-alt"></i> Delete</a>
    </div>
  </div>

  <div id="saveSearchModal" class="modal">
    <div class="modal-content">
      <div class="modal-title"><h3>Save Search Name</h3></div>
      <div class="save-search-name-input-wrapper">
        <div class="input-field">
          <input id="saveSearchNameInput" type="text" class="saveSearchNameInput-value">
          <label for="saveSearchNameInput">Enter name for save search</label>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <div class="button-wrapper">
        <a href="javascript:;" class="modal-close button-stroked button-primary"><i class="fas fa-times"></i> Cancel</a>
        <a href="javascript:;" class="modal-close button-primary save-saved-search-name"><i class="far fa-save"></i> Save</a>
      </div>
    </div>
  </div>

  <div id="updateItemRowModal" class="modal">
    <div class="modal-content">
      <p>Are you sure you want to update <strong id="updateItemRowModalName"></strong>.</p>
    </div>
    <div class="modal-footer">
      <a href="javascript:;" class="modal-close button-stroked button-primary"><i class="fas fa-times"></i> Cancel</a>
      <a href="javascript:;" class="modal-close button-primary removed-saved-search" id="updateItemRowModalButton" data-upc=""><i class="far fa-save"></i> Save</a>
    </div>
  </div>

  <div id="serverSideItemRowModal" class="modal">
    <div class="modal-content">
      <p><strong id="serverSideItemRowModallName"></strong> has already been updated. You can do following operation.</p>
    </div>
    <div class="modal-footer">
      <a href="javascript:;" class="modal-close button-stroked button-primary"><i class="fas fa-times"></i> Cancel</a>
      <a href="javascript:;" class="modal-close button-primary removed-saved-search serverSideItemRowModalButton" data-upc=""><i class="fab fa-firstdraft"></i> Show Latest Draft</a>
      <a href="javascript:;" class="modal-close button-primary removed-saved-search serverSideItemRowModalButton" data-upc=""><i class="fab fa-mixer"></i> Merge and Save</a>
      <a href="javascript:;" class="modal-close button-primary removed-saved-search serverSideItemRowModalButton" data-upc=""><i class="far fa-save"></i> Ignore and Save</a>
    </div>
  </div>


  <script src="js/vendor/modernizr-3.8.0.min.js"></script>
  <script src="js/vendor/jquery-3.4.1.min.js"></script>
  <script src="js/vendor/ag-grid-enterprise.min.js"></script>
  <script src="js/vendor/materialize.min.js"></script>
  <script src="js/vendor/datepicker.min.js"></script>
  <script src="js/vendor/datepicker.en.js"></script>

  <script src="js/main.js"></script>

  <script>
    var gridOptions;
    var newCount = 0;

    var columnDefs = [
      {
        headerName: "UPC", 
        field: "upc",
        headerCheckboxSelection: true,
        headerCheckboxSelectionFilteredOnly: true,
        checkboxSelection: true,
        minWidth: 240,
        cellRenderer: 'upcStatus'
      },
      {headerName: "PLU", field: "plu", editable: true},
      {headerName: "Description", field: "description", editable: true},
      {headerName: "Vendor ID", field: "vendor_id", editable: true},
      {headerName: "Vendor", field: "vendor", editable: true},
      {headerName: "Category", field: "category", editable: true},
      {headerName: "Class", field: "class", editable: true},
      {headerName: "Unit Price UPC", field: "unit_price_upc", editable: true},
      {headerName: "Case UPC", field: "case_upc", editable: true},
      {headerName: "Department ID", field: "department_id", editable: true},
      {headerName: "Family ID", field: "family_id", editable: true},
      {headerName: "AllowanceCode", field: "allowance_code", editable: true},
      {headerName: "AllowanceType", field: "allowance_type", editable: true},
      {headerName: "UnitAllow", field: "unit_allow", editable: true},
      {headerName: "StartDate", field: "start_date", editable: true},
      {headerName: "EndDate", field: "end_date", editable: true},
      {headerName: "Pack", field: "pack", editable: true},
      {headerName: "AllowanceCodeID", field: "allowance_code_id", editable: true},
      {headerName: "AllowanceCodeName", field: "allowance_code_name", editable: true},
      {headerName: "AllowanceTypeID", field: "allowance_type_id", editable: true},
      {headerName: "AllowanceTypeName", field: "allowance_type_name", editable: true},
      {headerName: "AlternateUPC", field: "alternate_upc", editable: true},
      {headerName: "AlternateCountRatio", field: "alternate_count_ratio", editable: true},
      {headerName: "CafeMenuID", field: "cafe_menu_id", editable: true},
      {headerName: "CafeMenuName", field: "cafe_menu_name", editable: true},
      {headerName: "BannerID", field: "banner_id", editable: true},
      {headerName: "CategoryID", field: "category_id", editable: true},
      {headerName: "ParentID", field: "parent_id", editable: true},
      {headerName: "CategoryName", field: "category_name", editable: true},
      {headerName: "SpecialistID", field: "specialist_id", editable: true},
      {headerName: "ClassID", field: "class_id", editable: true},
      {headerName: "DataEntryLinkID", field: "data_entry_link_id", editable: true},
      {headerName: "DataEntryLinkDescription", field: "data_entry_link_description", editable: true},
      {headerName: "FinancialDepartment", field: "financial_department", editable: true},
      {headerName: "TransferMargin", field: "transfer_margin", editable: true},
      {headerName: "BFContact", field: "bf_contact", editable: true},
      {headerName: "POSDescription", field: "pos_description", editable: true},
      {headerName: "AdvertisingDescription", field: "advertising_description", editable: true},
      {headerName: "Brand", field: "brand", editable: true},
      {headerName: "Family", field: "family", editable: true},
      {headerName: "Subcategory", field: "subcategory", editable: true},
      {headerName: "UnitSize", field: "unit_size", editable: true},
      {headerName: "RetailPack", field: "retail_pack", editable: true},
      {headerName: "CasePack", field: "case_pack", editable: true},
      {headerName: "OutOfSeason", field: "out_of_season", editable: true},
      {headerName: "PriceRule", field: "price_rule", editable: true},
      {headerName: "MixMatchCode", field: "mix_match_code", editable: true},
      {headerName: "TargetGM", field: "target_gm", editable: true},
      {headerName: "CouponInd", field: "coupon_ind", editable: true},
      {headerName: "POSPricingMethod", field: "pos_pricing_method", editable: true},
      {headerName: "PODLevel", field: "pod_level", editable: true},
      {headerName: "Yield", field: "yield", editable: true},
      {headerName: "BFSeasonalPromo", field: "bf_seasonal_promo", editable: true},
      {headerName: "CBD", field: "cbd", editable: true},
      {headerName: "CoreSet", field: "core_set", editable: true},
      {headerName: "CustomerRequest", field: "customer_request", editable: true},
      {headerName: "FairTrade", field: "fair_rade", editable: true},
      {headerName: "Foodstamp", field: "food_stamp", editable: true},
      {headerName: "GlutenFree", field: "gluten_free", editable: true},
      {headerName: "Instacart", field: "insta_cart", editable: true},
      {headerName: "InstacartTPR", field: "insta_cart_trp", editable: true},
      {headerName: "LASeasonalPromo", field: "la_seasonal_promo", editable: true},
      {headerName: "Local", field: "local", editable: true},
      {headerName: "Natural", field: "natural", editable: true},
      {headerName: "NGMO", field: "ngmo", editable: true},
      {headerName: "NotForSale", field: "not_for_sale", editable: true},
      {headerName: "Organic", field: "organic", editable: true},
      {headerName: "OrganicallyGrown", field: "organically_grown", editable: true},
      {headerName: "OverrideRequired", field: "override_required", editable: true},
      {headerName: "PlantBased", field: "plant_based", editable: true},
      {headerName: "PriceRequired", field: "price_required", editable: true},
      {headerName: "PrivateLabel", field: "private_label", editable: true},
      {headerName: "ProduceFIFO", field: "produce_fifo", editable: true},
      {headerName: "QtyAllowed", field: "qty_allowed", editable: true},
      {headerName: "QtyRequired", field: "qty_required", editable: true},
      {headerName: "Raw", field: "raw", editable: true},
      {headerName: "RemotePrinter", field: "remote_printer", editable: true},
      {headerName: "RPD", field: "rpd", editable: true},
      {headerName: "Seasonal", field: "seasonal", editable: true},
      {headerName: "TaxA", field: "tax_a", editable: true},
      {headerName: "TaxB", field: "tax_b", editable: true},
      {headerName: "TaxC", field: "tax_c", editable: true},
      {headerName: "TaxD", field: "tax_d", editable: true},
      {headerName: "TaxE", field: "tax_e", editable: true},
      {headerName: "Taxf", field: "tax_f", editable: true},
      {headerName: "TaxG", field: "tax_g", editable: true},
      {headerName: "TaxH", field: "tax_h", editable: true},
      {headerName: "ValueBF", field: "value_bf", editable: true},
      {headerName: "ValueLAM", field: "value_lam", editable: true},
      {headerName: "Vegan", field: "vegan", editable: true},
      {headerName: "SchematicName1", field: "schematic_name_1", editable: true},
      {headerName: "SchematicName2", field: "schematic_name_2", editable: true},
      {headerName: "Height", field: "height", editable: true},
      {headerName: "Depth", field: "depth", editable: true},
      {headerName: "Width", field: "width", editable: true},
      {headerName: "MOQ", field: "moq", editable: true},
      {headerName: "MMVendPack", field: "mm_vend_pack", editable: true},
      {headerName: "MMVendSize", field: "mm_vend_size", editable: true},
      {headerName: "MMVendUOM", field: "mm_vend_uom", editable: true},
    ];
    $.get("data/view-item.json", function(data, status){

      var mainData = data;
      gridOptions = {
        defaultColDef: {
          editable: false,
          resizable: true,
          enableCellChangeFlash: true,
          sortable:true,
          filter: true
        },
        rowSelection: 'multiple',
        columnDefs: columnDefs,
        masterDetail: true,
        rowData: mainData,
        pagination: true,
        editType: 'fullRow',
        paginationPageSize: 10,
        onRowSelected: onRowSelected,
        onSelectionChanged: onSelectionChanged,
        onFirstDataRendered: onFirstDataRendered,
        detailCellRendererParams: {
          detailGridOptions: {
            columnDefs: [
            {headerName: "Description", field: "description"},
            {headerName: "Vendor ID", field: "vendor_id"},
            {headerName: "Vendor", field: "vendor"},
            {headerName: "Category", field: "category"},
            {headerName: "Class", field: "class"},
            {headerName: "Unit Price UPC", field: "unit_price_upc"},
            {headerName: "Case UPC", field: "case_upc"},
            {headerName: "Department ID", field: "department_id"},
            {headerName: "Family ID", field: "family_id"},
            {headerName: "AllowanceCode", field: "allowance_code"},
            {headerName: "AllowanceType", field: "allowance_type"},
            {headerName: "UnitAllow", field: "unit_allow"},
            ],
            onFirstDataRendered: function(params) {
                // params.api.sizeColumnsToFit();
            }
          },
          getDetailRowData: function(params) {
            params.successCallback(params.data.childrenData);
          }
        },
        paginationNumberFormatter: function(params) {
          return '[' + params.value.toLocaleString() + ']';
        },
        onGridReady: function(params) {
          // params.api.sizeColumnsToFit();
          $('.disable-row-edit').each(function() {
            $(this).closest('.ag-row').addClass('disable-row');
          });

        },components: {
          'upcStatus': UPCStatus
        },
        onRowEditingStarted: function(event){
          var _this = this;
          $('.saveRow').css({'display': 'inline-block'});
          $('.disable-row-edit').closest('.ag-row').each(function() {
              if(parseInt($(this).attr('row-index')) === event.rowIndex) {
                _this.api.stopEditing();
              }
          });
        },
        onRowValueChanged: function(event) {
            var data = event.data,
                saveModalinstance = M.Modal.getInstance(document.querySelector('#updateItemRowModal'));
            $('#updateItemRowModal #updateItemRowModalName').text(data.upc);
            $('#updateItemRowModal #updateItemRowModalButton').attr('data-upc', data.upc);
            $('#updateItemRowModal #updateItemRowModalButton').attr('data-index', event.rowIndex);
            saveModalinstance.open();
        }
      };
      var gridDiv = document.querySelector('#datatable');
      new agGrid.Grid(gridDiv,  gridOptions);   
    });

    function onFirstDataRendered(params) {
      // arbitrarily expand a row for presentational purposes
      // setTimeout(function() { params.api.getDisplayedRowAtIndex(1).setExpanded(true); }, 0);
    }

    function onPageSizeChanged(newPageSize) {
      var value = document.getElementById('page-size').value;
      gridOptions.api.paginationSetPageSize(Number(value));
    }

    function onRowSelected(event) {
      console.log("row " + event.node.data.upc + " selected = " + event.node.selected);
    }

    function onSelectionChanged(event) {
      var rowCount = event.api.getSelectedNodes().length;
      console.log('selection changed, ' + rowCount + ' rows selected');
      if(rowCount > 0) {
        $('#select-row-num').html('('+rowCount + ' <span>selected</span>'+')');
        if($('#cardHeaderAction .button-wrapper .header-action-process').length === 0) {
          // $('#cardHeaderAction .button-wrapper').append('<a href="/pending-billing-process.html" class="button-primary header-action-item header-action-process"><i class="fas fa-cogs"></i> Process</a>');
        }
      } else {
        $('#select-row-num').html('');
        $('#cardHeaderAction .button-wrapper .header-action-process').remove();
      }
    }

    // cell renderer class
    function UPCStatus() {}

    // init method gets the details of the cell to be rendere
    UPCStatus.prototype.init = function(params) {
      this.eGui = document.createElement('div');
      this.eGui.classList.add('upc-status');
      var status = Math.floor(Math.random() * 3) + 1;
      if(status === 1) {
        this.eGui.innerHTML = '<a href="/item-view.html?upc='+params.value+'" title=""><i class=""></i> ' + params.value + '</a>';
      } else if(status === 2) {
        this.eGui.innerHTML = '<a href="/item-view.html?upc='+params.value+'" title="Draft"><i class="fab fa-firstdraft draftIconClick"></i> '+ params.value + '</a>';
      } else if(status === 3) {
        this.eGui.classList.add('disable-row-edit');
        this.eGui.innerHTML = '<a href="/item-view.html?upc='+params.value+'" title="Lock"><i class="fas fa-lock"></i> ' + params.value + '</a>';
      }
    };

    UPCStatus.prototype.getGui = function() {
      return this.eGui;
    };

    $(document).ready(function() { 
      $(window).on("load resize ",function(e){
        $('#datatable').outerHeight($(document).outerHeight(true) - $('.header-container').outerHeight(true) - $('.header-search-card-wrapper').outerHeight(true) - $('.main-body-data-wrapper .card-header').outerHeight(true) - 40);
      });

      function createNewRowData() {
          var newData = {
            upc:"UPC00000000"+newCount
          };
          return newData;
      }

      $('body').on('click', '.addNewRow', function(event) {
        event.preventDefault();
          newCount++;

        window.location.href = 'add-item-data.html';

        // var newItem = createNewRowData();

        // var res = gridOptions.api;
        // res.updateRowData({add: [newItem], addIndex: 0});
      });

      function updateItemRow(rowIndex, upc) {
        $('#datatable .ag-center-cols-container .ag-row').each(function(){
          if(parseInt($(this).attr('row-index')) === parseInt(rowIndex) && !$(this).hasClass('edited-row')){
              $(this).addClass('edited-row')
            }
        });
        M.toast({html: 'Value for '+upc+' changed.'});
      }

      $('body').on('click', '#updateItemRowModal #updateItemRowModalButton', function(event) {
        var upc = $('#updateItemRowModal #updateItemRowModalButton').attr('data-upc'),
            rowIndex = $('#updateItemRowModal #updateItemRowModalButton').attr('data-index'),
            saveModalinstance = M.Modal.getInstance(document.querySelector('#serverSideItemRowModal')),
            status = Math.floor(Math.random() * 2) + 1;

        $('.saveRow').css({'display': 'none'});
        if(status === 1) {
          updateItemRow(rowIndex, upc);
        } else {
          $('#serverSideItemRowModallName').text(upc);
          saveModalinstance.open();
        }
        
      });

      $('body').on('click', '#serverSideItemRowModal .serverSideItemRowModalButton', function(event) {
        var upc = $('#updateItemRowModal #updateItemRowModalButton').attr('data-upc'),
            rowIndex = $('#updateItemRowModal #updateItemRowModalButton').attr('data-index');
        
        updateItemRow(rowIndex, upc);
      });

      $('body').on('click', '.saveRow', function(event) {
        event.preventDefault();
        gridOptions.api.stopEditing()
      });

      $('body').on('click', '.draftIconClick', function(event) {
        event.preventDefault();
        if($(event.currentTarget).closest('.ag-row').hasClass('row-expanded')) {
          $(event.currentTarget).closest('.ag-row').removeClass('row-expanded');
          gridOptions.api.getDisplayedRowAtIndex(parseInt($(event.currentTarget).closest('.ag-row').attr('row-id'))).setExpanded(false);
        } else {
          $(event.currentTarget).closest('.ag-row').addClass('row-expanded');
          gridOptions.api.getDisplayedRowAtIndex(parseInt($(event.currentTarget).closest('.ag-row').attr('row-id'))).setExpanded(true);
        }
      });

      

      $('.datepicker-here').each(function() {
        var dp = $(this).datepicker().data('datepicker');
        dp.selectDate(new Date($(this).attr('value')));
      });
    });
  </script>

  <!-- Google Analytics: change UA-XXXXX-Y to be your site's ID. -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-XXXXX-Y', 'auto'); ga('set','transport','beacon'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async></script>
</body>

</html>