<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title>Pending Items | Bristol Farms</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Place favicon.ico in the root directory -->
  <link rel="icon" type="image/x-icon" href="favicon.ico">

  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600|Raleway:400,600,700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons&display=block" rel="stylesheet">
  <link href="./css/vendor/fontawesome.css" rel="stylesheet">
  <link rel="stylesheet" href="./css/vendor/datepicker.min.css">
  <link rel="stylesheet" href="./css/vendor/materialize.min.css">
  <link rel="stylesheet" href="css/styles.css">

  <meta name="theme-color" content="#fafafa">
</head>

<body class="left-menu-fixed">

  <div class="body-container-wrapper">
    <div class="body-wrapper">

      <!-- Header -->
      <header class="header-container">
        <div class="header-container-wrapper">
          <div class="container-fluid">
            <div class="row">
              <div class="col-sm-10 header-left-wrapper">
                <div class="cell-wrapper">
                  <div class="header-title-nav-wrapper">
                    <div class="title">
                      <h3>Pending Items</h3>
                      <div aria-label="breadcrumb">
                        <ol class="breadcrumb">
                          <li class="breadcrumb-item"><a href="/">Home</a></li>
                          <li class="breadcrumb-item active" aria-current="page">Pending Items</li>
                        </ol>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-2 header-right-wrapper text-right">
                <div class="cell-wrapper">
                  <div class="header-dropdown-wrapper">
                    <a href="javascript:;" class="header-dropdown-trigger"><i class="far fa-user-circle"></i></a>
                    <div class="dropdown-menu text-left">
                      <div class="header-dropdown-user-profile-wrapper text-center">
                        <div class="user-avatar-wrapper">
                          <i class="far fa-user-circle"></i>
                        </div>
                        <div class="user-detail-wrapper">
                          <h3><a href="javascript:;">User Name</a></h3>
                          <h5>Admin</h5>
                        </div>
                      </div>
                      <ul>
                        <li><a href="javascript:;">Menu 1</a></li>
                        <li><a href="javascript:;">Menu 2</a></li>
                        <li><a href="javascript:;">Menu 3</a></li>
                        <li><a href="javascript:;">Logout</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Left Menu -->
      <div class="left-menu-wrapper"></div>

      <!-- Main Body Content -->
      <div class="main-body-content-wrapper">
        <div class="main-body-content-container">

          <div class="header-search-wrapper">
            <div class="container-fluid">
              <div class="card header-search-card-wrapper">
                <div class="card-content">
                  <h3 class="card-title d-flex flex-row justify-content-between d-flex align-items-center">
                    <span>Search</span>
                  </h3>
                  <div class="row header-search-input-wrapper align-items-center justify-content-start">
                    <div class="col-md-1">
                      <div class="cell-wrapper">
                        <div class="input-field">
                          <input id="UPC_PLU_Search" type="text" value="" autocomplete="off" placeholder="Enter UPC/PLU value">
                          <label for="UPC_PLU_Search" class="active">UPC/PLU</label>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="cell-wrapper">
                        <div class="input-field">
                          <input id="Item_Description_Search" type="text" value="" autocomplete="off" placeholder="Enter Item Description value">
                          <label for="Item_Description_Search" class="active">Item Description</label>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="cell-wrapper">
                        <div class="input-field">
                          <select>
                            <option value="" disabled selected>Choose</option>
                            <option value="1">Option 1</option>
                            <option value="2">Option 2</option>
                            <option value="3">Option 3</option>
                          </select>
                          <label>Department</label>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="cell-wrapper">
                        <div class="input-field">
                          <select>
                            <option value="" disabled selected>Choose</option>
                            <option value="1">Option 1</option>
                            <option value="2">Option 2</option>
                            <option value="3">Option 3</option>
                          </select>
                          <label>Category</label>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="cell-wrapper">
                        <div class="input-field">
                          <input id="Brand_Search" type="text" value="" autocomplete="off" placeholder="Enter Brand value">
                          <label for="Brand_Search" class="active">Brand</label>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="cell-wrapper">
                        <div class="input-field">
                          <select>
                            <option value="" disabled selected>Choose</option>
                            <option value="1">Option 1</option>
                            <option value="2">Option 2</option>
                            <option value="3">Option 3</option>
                          </select>
                          <label>Vendor Name</label>
                        </div>
                      </div>
                    </div>
                    <div class="row header-search-btn-wrapper align-items-start justify-content-center">
                      <div class="col-sm-12">
                        <div class="cell-wrapper d-flex flex-row justify-content-between align-items-center">
                          <a href="/view-item-data.html" class="button-primary button-search">Search</a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="main-body-data-wrapper">
            <div class="container-fluid">
              <div class="card">
                <div class="card-content">
                  <div class="card-header d-flex flex-row justify-content-between align-items-center">
                    <div class="card-title-wrapper">
                      <h3 class="card-title">
                        Pending Items
                        <span id="select-row-num"></span>
                      </h3>
                    </div>
                    <div class="card-header-action-wrapper" id="cardHeaderAction">
                      <div class="button-wrapper d-flex flex-row justify-content-end align-items-center">
                        <button type="button" class="button-primary button-stroked saveRow header-action-item">Save Row</button>
                      </div>
                    </div>
                  </div>
                  <div class="datatable-wrapper">
                    <div id="datatable" class="datatable ag-theme-material"></div>
                    <div class="datatable-action-item-select">
                      <div class="d-flex flex-row justify-content-end align-items-center">
                        <span class="page-size-label">Item to Show</span>
                        <select onchange="onPageSizeChanged()" id="page-size">
                          <option value="10">10</option>
                          <option value="20">20</option>
                          <option value="50">50</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>

  <div id="updateItemRowModal" class="modal">
    <div class="modal-content">
      <p>Are you sure you want to <span class="statusMsgType"></span> <strong id="updateItemRowModalName"></strong>.</p>
      <div class="input-field ">
        <textarea id="updateItemRowModalTextarea" class="materialize-textarea"></textarea>
        <label for="updateItemRowModalTextarea">Comment</label>
      </div>
    </div>
    <div class="modal-footer">
      <a href="javascript:;" class="modal-close button-stroked button-primary"><i class="fas fa-times"></i> Cancel</a>
      <a href="javascript:;" class="modal-close button-primary removed-saved-search" id="updateItemRowModalButton" data-upc=""><i class="statusMsgTypeIcon"></i> <span class="statusMsgType"></span></a>
    </div>
  </div>


  <script src="js/vendor/modernizr-3.8.0.min.js"></script>
  <script src="js/vendor/jquery-3.4.1.min.js"></script>
  <script src="js/vendor/ag-grid-enterprise.min.js"></script>
  <script src="js/vendor/materialize.min.js"></script>
  <script src="js/vendor/datepicker.min.js"></script>
  <script src="js/vendor/datepicker.en.js"></script>


  <script src="js/main.js"></script>

  <script>
    var gridOptions;
      var columnDefs = [
        {
          headerName: "UPC", 
          field: "upc",
          minWidth: 240,
          cellRenderer: 'agGroupCellRenderer'
        },
        {headerName: "PLU", field: "plu"},
        {headerName: "Name", field: "name"},
        {headerName: "Submission Info", field: "submitted_by"},
        {headerName: "Action", field: "action", cellRenderer: 'gridAction'},
      ];
      $.get("data/pending-item.json", function(data, status){
        gridOptions = {
          defaultColDef: {
            editable: false,
            resizable: true,
            sortable:true,
            filter: true
          },
          columnDefs: columnDefs,
          rowData: data,
          pagination: true,
          paginationPageSize: 10,
          onRowSelected: onRowSelected,
          onSelectionChanged: onSelectionChanged,
          masterDetail: true,
          suppressContextMenu:true,
          detailCellRendererParams: {
            detailGridOptions: {
              columnDefs: [
                {headerName: "Attribute", field: "attribute"},
                {headerName: "Old Value", field: "old_value"},
                {headerName: "New Value", field: "new_value"},
                {headerName: "Action", field: "action", cellRenderer: 'gridAction'}
              ],
              components: {
                'gridAction': GidAction
              },
              onFirstDataRendered: function(params) {
                  params.api.sizeColumnsToFit();
              }
            },
            components: {
              'gridAction': GidAction
            },
            getDetailRowData: function(params) {
              params.successCallback(params.data.childdata);
            }
          },
          onFirstDataRendered: function(params) {
            params.api.sizeColumnsToFit();
          },
          paginationNumberFormatter: function(params) {
              return '[' + params.value.toLocaleString() + ']';
          },
          components: {
            'gridAction': GidAction
          }
        };
        var gridDiv = document.querySelector('#datatable');
        new agGrid.Grid(gridDiv, gridOptions);    
      });

    function onPageSizeChanged(newPageSize) {
      var value = document.getElementById('page-size').value;
      gridOptions.api.paginationSetPageSize(Number(value));
    }

    function onRowSelected(event) {
      console.log("row " + event.node.data.upc + " selected = " + event.node.selected);
    }

    // cell renderer class
    function GidAction() {}

    // init method gets the details of the cell to be rendere
    GidAction.prototype.init = function(params) {
      this.eGui = document.createElement('div');
      this.eGui.classList.add('datatabel-action-btn-wrapper');
      var html = '';
      if(params.data.old_value && params.data.new_value) {
        html = '<a href="javascript:;" title="Edit" class="editFileBtn"  data-row-index="'+params.rowIndex+'"><i class="far fa-edit"></i></a>';
        html = html + '<a href="javascript:;" title="Revert" class="revertFileBtn"  data-row-index="'+params.rowIndex+'"><i class="fas fa-undo-alt"></i></a>';
      } else {
        html = '<a href="javascript:;" title="View" class="viewFileBtn" data-row-index="'+params.rowIndex+'"><i class="far fa-eye"></i></a>';
        html = html + '<a href="javascript:;" title="Approve" class="approveFileBtn" data-row-index="'+params.rowIndex+'"><i class="fas fa-check"></i></a>';
        html = html + '<a href="javascript:;" title="Revert" class="revertFileBtn" data-row-index="'+params.rowIndex+'"><i class="fas fa-undo-alt"></i></a>';
        html = html + '<a href="javascript:;" title="Reject" class="rejectFileBtn" data-row-index="'+params.rowIndex+'"><i class="fas fa-times"></i></a>';
      }
      this.eGui.innerHTML = html;
    };

    GidAction.prototype.getGui = function() {
      return this.eGui;
    };

    function onSelectionChanged(event) {
      var rowCount = event.api.getSelectedNodes().length;
      console.log('selection changed, ' + rowCount + ' rows selected');
      if(rowCount > 0) {
        $('#select-row-num').html('('+rowCount + ' <span>selected</span>'+')');
        if($('#cardHeaderAction .button-wrapper .header-action-process').length === 0) {
          $('#cardHeaderAction .button-wrapper').append('<a href="/pending-billing-process.html" class="button-primary header-action-item header-action-process"><i class="fas fa-cogs"></i> Process</a>');
        }
      } else {
        $('#select-row-num').html('');
        $('#cardHeaderAction .button-wrapper .header-action-process').remove();
      }
    }

    $(document).ready(function() { 
      $(window).on("load resize ",function(e){
        $('#datatable').outerHeight($(document).outerHeight(true) - $('.header-container').outerHeight(true) - $('.header-search-card-wrapper').outerHeight(true) - $('.main-body-data-wrapper .card-header').outerHeight(true) - 40);
      });

      var modalInstance  = M.Modal.getInstance(document.querySelector('#updateItemRowModal'));

      $('body').on('click', '.approveFileBtn', function(event) {
        event.preventDefault();
        $('#updateItemRowModal .statusMsgTypeIcon').removeClass();
        $('#updateItemRowModal #updateItemRowModalButton > i').addClass('statusMsgTypeIcon fas fa-check');
        $('#updateItemRowModal .statusMsgType').text('approve');
        modalInstance.open();
      });

      $('body').on('click', '.revertFileBtn', function(event) {
        event.preventDefault();
        $('#updateItemRowModal .statusMsgTypeIcon').removeClass();
        $('#updateItemRowModal #updateItemRowModalButton > i').addClass('statusMsgTypeIcon fas fa-undo-alt');
        $('#updateItemRowModal .statusMsgType').text('revert');
        modalInstance.open();
      });

      $('body').on('click', '.rejectFileBtn', function(event) {
        event.preventDefault();
        $('#updateItemRowModal .statusMsgTypeIcon').removeClass();
        $('#updateItemRowModal #updateItemRowModalButton > i').addClass('statusMsgTypeIcon fas fa-times');
        $('#updateItemRowModal .statusMsgType').text('reject');
        modalInstance.open();
      });

      $('body').on('click', '.editFileBtn', function(event) {
        event.preventDefault();
        // debugger;
      });
    });
  </script>

  <!-- Google Analytics: change UA-XXXXX-Y to be your site's ID. -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-XXXXX-Y', 'auto'); ga('set','transport','beacon'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async></script>
</body>

</html>